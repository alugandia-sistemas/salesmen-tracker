FROM node:18-alpine AS builder
WORKDIR /app
COPY frontend/package*.json ./
RUN npm install --legacy-peer-deps
COPY frontend/ .
RUN npm run build

FROM node:18-alpine
WORKDIR /app

# ✅ Instalar http-server en lugar de serve
RUN npm install -g http-server

COPY --from=builder /app/dist ./dist
EXPOSE 5173

# ✅ http-server escucha en 0.0.0.0 por defecto
CMD ["http-server", "dist", "-p", "5173", "-a", "0.0.0.0"]